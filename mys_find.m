clear all;
close all;
clc;

I=imread('../fig/geotest2.png');
imshow(I);

O=[2703,1854];
x=[4178;...
  4046;...
  3854;...
  3635;...
  3395;...
  3319;...
  3429;...
  3614;...
  3833;...
  3662;...
  3484;...
  3338;...
  3306;...
  3456;...
  3505;...
  3464;...
  3333;...
  3142;...
  3101;...
  3176;...
  3258;...
  3251;...
  3190;...
  3155];
y= [1854;...
  1813;...
  1854;...
  1964;...
  2025;...
  1854;...
  1697;...
  1559;...
  1436;...
  1313;...
  1258;...
  1297;...
  1422;...
  1436;...
  1306;...
  1114;...
  970;...
  984;...
  1043;...
  1142;...
  1053;...
  833;...
  540;...
  451];
  
  
x=interp1(x,[1:0.1:length(x)-0.1],'spline')';
y=interp1(y,[1:0.1:length(y)-0.1],'spline')';  
r=sqrt((x-O(1)).^2+(y-O(2)).^2);
th=atan((O(2)-y)./(x-O(1)));
z=r.*exp(1i*th);
figure;plot(real(z),imag(z),'ro-');
TH=2*pi/5;
r=[r;r;r;r;r];
th=[th;th+TH*1;th+TH*2;th+TH*3;th+TH*4];
z=r.*exp(1i*th);
figure;plot(real(z),imag(z),'ro-');axis square;

Z=fft(z);
Z(25:95)=0;
z2=ifft(Z);
figure;plot(real(z2),imag(z2),'ro-');axis square;